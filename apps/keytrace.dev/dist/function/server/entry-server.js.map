{"version":3,"file":"entry-server.js","sources":["../../src/App.tsx","../../src/entry-server.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\"\n\ninterface Session {\n  authenticated: boolean\n  did?: string\n  handle?: string\n  displayName?: string\n  avatar?: string\n}\n\nexport function App() {\n  const [session, setSession] = useState<Session | null>(null)\n  const [handle, setHandle] = useState(\"\")\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    fetch(\"/oauth/session\")\n      .then((res) => res.json())\n      .then((data) => {\n        setSession(data)\n        setLoading(false)\n      })\n      .catch(() => setLoading(false))\n  }, [])\n\n  const handleLogin = (e: React.FormEvent) => {\n    e.preventDefault()\n    if (handle) {\n      window.location.href = `/oauth/login?handle=${encodeURIComponent(handle)}`\n    }\n  }\n\n  const handleLogout = async () => {\n    await fetch(\"/oauth/logout\", { method: \"POST\" })\n    setSession({ authenticated: false })\n  }\n\n  if (loading) {\n    return <div>Loading...</div>\n  }\n\n  return (\n    <div style={{ padding: \"2rem\", fontFamily: \"system-ui\" }}>\n      <h1>keytrace.dev</h1>\n\n      {session?.authenticated ? (\n        <div>\n          <div style={{ display: \"flex\", alignItems: \"center\", gap: \"1rem\", marginBottom: \"1rem\" }}>\n            {session.avatar && (\n              <img\n                src={session.avatar}\n                alt=\"\"\n                style={{ width: 48, height: 48, borderRadius: \"50%\" }}\n              />\n            )}\n            <div>\n              <div style={{ fontWeight: \"bold\" }}>{session.displayName || session.handle}</div>\n              <div style={{ color: \"#666\" }}>@{session.handle}</div>\n              <div style={{ fontSize: \"0.8rem\", color: \"#999\" }}>{session.did}</div>\n            </div>\n          </div>\n          <button onClick={handleLogout}>Logout</button>\n        </div>\n      ) : (\n        <form onSubmit={handleLogin}>\n          <p>Sign in with your Bluesky handle:</p>\n          <input\n            type=\"text\"\n            value={handle}\n            onChange={(e) => setHandle(e.target.value)}\n            placeholder=\"you.bsky.social\"\n            style={{ padding: \"0.5rem\", marginRight: \"0.5rem\" }}\n          />\n          <button type=\"submit\">Login with Bluesky</button>\n        </form>\n      )}\n    </div>\n  )\n}\n","import { renderToString } from 'react-dom/server'\nimport { App } from './App'\n\nexport async function render(_url: string): Promise<string> {\n  return renderToString(<App />)\n}\n"],"names":[],"mappings":";;;AAUO,SAAS,MAAM;AACpB,QAAM,CAAC,SAAS,UAAU,IAAI,SAAyB,IAAI;AAC3D,QAAM,CAAC,QAAQ,SAAS,IAAI,SAAS,EAAE;AACvC,QAAM,CAAC,SAAS,UAAU,IAAI,SAAS,IAAI;AAE3C,YAAU,MAAM;AACd,UAAM,gBAAgB,EACnB,KAAK,CAAC,QAAQ,IAAI,MAAM,EACxB,KAAK,CAAC,SAAS;AACd,iBAAW,IAAI;AACf,iBAAW,KAAK;AAAA,IAClB,CAAC,EACA,MAAM,MAAM,WAAW,KAAK,CAAC;AAAA,EAClC,GAAG,CAAA,CAAE;AAEL,QAAM,cAAc,CAAC,MAAuB;AAC1C,MAAE,eAAA;AACF,QAAI,QAAQ;AACV,aAAO,SAAS,OAAO,uBAAuB,mBAAmB,MAAM,CAAC;AAAA,IAC1E;AAAA,EACF;AAEA,QAAM,eAAe,YAAY;AAC/B,UAAM,MAAM,iBAAiB,EAAE,QAAQ,QAAQ;AAC/C,eAAW,EAAE,eAAe,OAAO;AAAA,EACrC;AAEA,MAAI,SAAS;AACX,WAAO,oBAAC,SAAI,UAAA,aAAA,CAAU;AAAA,EACxB;AAEA,SACE,qBAAC,SAAI,OAAO,EAAE,SAAS,QAAQ,YAAY,eACzC,UAAA;AAAA,IAAA,oBAAC,QAAG,UAAA,eAAA,CAAY;AAAA,KAEf,mCAAS,iBACR,qBAAC,OAAA,EACC,UAAA;AAAA,MAAA,qBAAC,OAAA,EAAI,OAAO,EAAE,SAAS,QAAQ,YAAY,UAAU,KAAK,QAAQ,cAAc,OAAA,GAC7E,UAAA;AAAA,QAAA,QAAQ,UACP;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,KAAK,QAAQ;AAAA,YACb,KAAI;AAAA,YACJ,OAAO,EAAE,OAAO,IAAI,QAAQ,IAAI,cAAc,MAAA;AAAA,UAAM;AAAA,QAAA;AAAA,6BAGvD,OAAA,EACC,UAAA;AAAA,UAAA,oBAAC,OAAA,EAAI,OAAO,EAAE,YAAY,UAAW,UAAA,QAAQ,eAAe,QAAQ,OAAA,CAAO;AAAA,+BAC1E,OAAA,EAAI,OAAO,EAAE,OAAO,UAAU,UAAA;AAAA,YAAA;AAAA,YAAE,QAAQ;AAAA,UAAA,GAAO;AAAA,UAChD,oBAAC,OAAA,EAAI,OAAO,EAAE,UAAU,UAAU,OAAO,OAAA,GAAW,UAAA,QAAQ,IAAA,CAAI;AAAA,QAAA,EAAA,CAClE;AAAA,MAAA,GACF;AAAA,MACA,oBAAC,UAAA,EAAO,SAAS,cAAc,UAAA,SAAA,CAAM;AAAA,IAAA,EAAA,CACvC,IAEA,qBAAC,QAAA,EAAK,UAAU,aACd,UAAA;AAAA,MAAA,oBAAC,OAAE,UAAA,oCAAA,CAAiC;AAAA,MACpC;AAAA,QAAC;AAAA,QAAA;AAAA,UACC,MAAK;AAAA,UACL,OAAO;AAAA,UACP,UAAU,CAAC,MAAM,UAAU,EAAE,OAAO,KAAK;AAAA,UACzC,aAAY;AAAA,UACZ,OAAO,EAAE,SAAS,UAAU,aAAa,SAAA;AAAA,QAAS;AAAA,MAAA;AAAA,MAEpD,oBAAC,UAAA,EAAO,MAAK,UAAS,UAAA,qBAAA,CAAkB;AAAA,IAAA,EAAA,CAC1C;AAAA,EAAA,GAEJ;AAEJ;AC3EA,eAAsB,OAAO,MAA+B;AAC1D,SAAO,eAAe,oBAAC,KAAA,CAAA,CAAI,CAAE;AAC/B;"}